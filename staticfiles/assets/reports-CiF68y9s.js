import{j as e}from"./ui-vendor-BwlLg9O9.js";import{C as i,a as m,b as h,d as n}from"./card-B87lmAsb.js";import{B as x,a as g}from"./index-DvB6HgzU.js";import{I as U}from"./input-CqLO7V2k.js";import{B as N}from"./badge-BSpsjrqz.js";import{S as l}from"./skeleton-CR7iafWw.js";import{r}from"./react-vendor-BV8CqAlW.js";import{f as E}from"./currency-DQnJccph.js";import{K as L,b as k,C as y}from"./utils-vendor-BEyFXcp4.js";function z(){const[w,b]=r.useState([]),[S,C]=r.useState([]),[d,p]=r.useState(!0),[u,j]=r.useState(null),[a,_]=r.useState("");r.useEffect(()=>{(async()=>{try{p(!0),j(null);const[t,o]=await Promise.all([g.get("/api/core/reports/scheme-usage/"),g.get("/api/core/reports/disease-stats/")]);b(t.results),C(o.results)}catch(t){console.error("Error fetching reports:",t),j("Failed to load reports data")}finally{p(!1)}})()},[]);const R=async()=>{try{const s=await fetch("/api/core/reports/scheme-usage/?format=csv",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(s.ok){const t=await s.blob(),o=window.URL.createObjectURL(t),c=document.createElement("a");c.href=o,c.download="scheme_usage_report.csv",document.body.appendChild(c),c.click(),window.URL.revokeObjectURL(o),document.body.removeChild(c)}}catch(s){console.error("Error exporting CSV:",s)}},f=w.filter(s=>String(s.patient__scheme__name||"").toLowerCase().includes(a.toLowerCase())),v=S.filter(s=>String(s.service_type||"").toLowerCase().includes(a.toLowerCase()));return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Reports"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Export and schedule reports."})]}),e.jsxs(i,{children:[e.jsx(m,{children:e.jsx(h,{className:"text-base",children:"Report toolbar"})}),e.jsx(n,{children:e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(U,{placeholder:"Filter by scheme or service type",className:"w-64",value:a,onChange:s=>_(s.target.value)}),e.jsxs(x,{onClick:R,disabled:d,children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Export CSV"]}),e.jsxs(x,{variant:"outline",disabled:!0,children:[e.jsx(k,{className:"h-4 w-4 mr-2"}),"Export PDF"]}),e.jsx(x,{variant:"outline",disabled:!0,children:"Scheduleâ€¦"})]})})]}),u&&e.jsx(i,{children:e.jsx(n,{className:"p-6",children:e.jsx("div",{className:"text-center text-destructive",children:u})})}),e.jsxs(i,{children:[e.jsx(m,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5"}),"Scheme Usage Report (Last 30 Days)"]})}),e.jsx(n,{children:d?e.jsx("div",{className:"space-y-3",children:Array.from({length:5}).map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded",children:[e.jsx(l,{className:"h-4 w-32"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(l,{className:"h-4 w-16"}),e.jsx(l,{className:"h-4 w-20"})]})]},t))}):f.length===0?e.jsx("div",{className:"text-center text-muted-foreground py-8",children:a?"No schemes match your filter":"No scheme usage data available"}):e.jsx("div",{className:"space-y-2",children:f.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded hover:bg-muted/50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.patient__scheme__name||"Unknown Scheme"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Claims processed"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(N,{variant:"info",children:[s.total_claims," claims"]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium",children:E(s.total_amount)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total value"})]})]})]},t))})})]}),e.jsxs(i,{children:[e.jsx(m,{children:e.jsxs(h,{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-5 w-5"}),"Service Type Statistics"]})}),e.jsx(n,{children:d?e.jsx("div",{className:"space-y-3",children:Array.from({length:5}).map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded",children:[e.jsx(l,{className:"h-4 w-32"}),e.jsx(l,{className:"h-4 w-16"})]},t))}):v.length===0?e.jsx("div",{className:"text-center text-muted-foreground py-8",children:a?"No service types match your filter":"No service type data available"}):e.jsx("div",{className:"space-y-2",children:v.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded hover:bg-muted/50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.service_type||"Unknown Service"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Service category"})]}),e.jsxs(N,{variant:"info",children:[s.total," claims"]})]},t))})})]})]})}export{z as default};

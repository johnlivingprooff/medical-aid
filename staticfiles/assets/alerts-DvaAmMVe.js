import{j as e}from"./ui-vendor-BwlLg9O9.js";import{C as n,a as h,b as j,c as u,d}from"./card-B87lmAsb.js";import{B as f}from"./badge-BSpsjrqz.js";import{S as a}from"./skeleton-CR7iafWw.js";import{r as i}from"./react-vendor-BV8CqAlW.js";import{j as g,a as v}from"./index-DvB6HgzU.js";import"./utils-vendor-BEyFXcp4.js";function R(){const[r,l]=i.useState([]),[p,c]=i.useState(!0),[m,x]=i.useState(null);i.useEffect(()=>{(async()=>{try{c(!0),x(null);const t=await v.get("/api/alerts/");l(t.results)}catch(t){console.error("Error fetching alerts:",t),x("Failed to load alerts")}finally{c(!1)}})()},[]);const N=async s=>{try{l(r.map(t=>t.id===s?{...t,is_read:!0}:t))}catch(t){console.error("Error marking alert as read:",t)}},o=r.filter(s=>!s.is_read).length;return p?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Alerts"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Real‑time alerts and fraud signals."})]}),e.jsxs(n,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(j,{children:"Stream"}),e.jsx(u,{children:"Newest first"})]}),e.jsx(a,{className:"h-5 w-8"})]}),e.jsx(d,{children:e.jsx("div",{className:"space-y-4",children:Array.from({length:5}).map((s,t)=>e.jsxs("div",{className:"flex items-start gap-3 py-3",children:[e.jsx(a,{className:"h-2.5 w-2.5 rounded-full mt-1"}),e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsx(a,{className:"h-4 w-3/4"}),e.jsx(a,{className:"h-3 w-1/2"})]})]},t))})})]})]}):m?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Alerts"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Real‑time alerts and fraud signals."})]}),e.jsx(n,{children:e.jsx(d,{className:"p-6",children:e.jsx("div",{className:"text-center text-destructive",children:m})})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Alerts"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Real‑time alerts and fraud signals."})]}),e.jsxs(n,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(j,{children:"Stream"}),e.jsx(u,{children:"Newest first"})]}),e.jsx(f,{variant:o>0?"warning":"default",children:o})]}),e.jsx(d,{children:r.length===0?e.jsx("div",{className:"text-center text-muted-foreground py-8",children:"No alerts to display"}):e.jsx("ul",{className:"divide-y divide-border text-sm",children:r.map(s=>e.jsxs("li",{className:`flex items-start gap-3 py-3 ${s.is_read?"":"bg-muted/30"}`,children:[e.jsx("span",{className:`mt-1 h-2.5 w-2.5 rounded-full ${s.severity==="HIGH"?"bg-destructive":s.severity==="MEDIUM"?"bg-warning":"bg-info"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"font-medium",children:s.message}),!s.is_read&&e.jsx(f,{variant:"info",className:"ml-2 text-xs",children:"New"})]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[s.type," • ",s.patient_id&&`Patient ID: ${s.patient_id} • `,g(s.created_at)]}),e.jsxs("div",{className:"mt-2 flex gap-2 text-xs",children:[s.patient_id&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"text-accent hover:underline",children:"View Patient"}),e.jsx("span",{className:"text-muted-foreground",children:"•"})]}),e.jsx("button",{className:"text-accent hover:underline",children:"View Details"}),!s.is_read&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-muted-foreground",children:"•"}),e.jsx("button",{className:"text-accent hover:underline",onClick:()=>N(s.id),children:"Mark Read"})]})]})]})]},s.id))})})]})]})}export{R as default};

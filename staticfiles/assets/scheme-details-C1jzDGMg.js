import{j as e}from"./ui-vendor-BwlLg9O9.js";import{i as _,u as C,r}from"./react-vendor-BV8CqAlW.js";import{C as d,a as n,b as c,c as l,d as m}from"./card-B87lmAsb.js";import{a as S,B as p}from"./index-DvB6HgzU.js";import{f as o}from"./currency-DQnJccph.js";import{M as D}from"./manage-schemes-modal-DMLno14B.js";import"./utils-vendor-BEyFXcp4.js";import"./input-CqLO7V2k.js";import"./label-_J7CDay_.js";function F(){var g,f;const{id:a}=_(),v=C(),[t,N]=r.useState(null),[y,x]=r.useState(!1),[h,u]=r.useState(null),[b,j]=r.useState(!1);return r.useEffect(()=>{if(!a)return;let s=!0;return x(!0),u(null),S.get(`/api/schemes/categories/${a}/details/`).then(i=>{s&&N(i)}).catch(i=>{s&&u(i.message||"Failed to load scheme")}).finally(()=>{s&&x(!1)}),()=>{s=!1}},[a]),y?e.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading…"}):h?e.jsx("div",{className:"text-sm text-destructive",children:h}):t?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-end justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{children:t.name}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:t.description||"No description"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{variant:"ghost",onClick:()=>v("/schemes"),children:"Back"}),e.jsx(p,{onClick:()=>j(!0),children:"Edit"})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:e.jsxs(d,{children:[e.jsxs(n,{children:[e.jsx(c,{children:"Scheme Price"}),e.jsx(l,{children:"Sum of benefit limits"})]}),e.jsx(m,{children:e.jsx("div",{className:"text-2xl font-semibold",children:o(t.price||0)})})]})}),e.jsxs(d,{children:[e.jsxs(n,{children:[e.jsx(c,{children:"Benefits Breakdown"}),e.jsx(l,{children:"Individual benefits and coverage details"})]}),e.jsx(m,{children:e.jsx("div",{className:"space-y-4",children:(g=t.benefits)!=null&&g.length?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-4 border-2 rounded-lg border-primary/20 bg-primary/5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Total Benefits Value"}),e.jsx("div",{className:"text-2xl font-bold text-primary",children:o(t.price||0)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Active Benefits"}),e.jsx("div",{className:"text-lg font-semibold",children:t.benefits.filter(s=>s.is_active).length})]})]})}),e.jsx("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-3",children:t.benefits.map(s=>e.jsx("div",{className:"p-4 border rounded-lg shadow-sm bg-card",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium",children:s.benefit_type_detail.name}),e.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-1 text-xs font-medium ${s.is_active?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300":"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300"}`,children:s.is_active?"Active":"Inactive"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Coverage Amount"}),e.jsx("span",{className:"font-medium",children:s.coverage_amount?o(s.coverage_amount):"Unlimited"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Period"}),e.jsx("span",{className:"font-medium",children:s.coverage_period.replace("_"," ").toLowerCase().replace(/\b\w/g,i=>i.toUpperCase())})]}),s.coverage_limit_count&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Limit Count"}),e.jsx("span",{className:"font-medium",children:s.coverage_limit_count})]}),s.waiting_period_days>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Waiting Period"}),e.jsxs("span",{className:"font-medium",children:[s.waiting_period_days," days"]})]})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Effective: ",new Date(s.effective_date).toLocaleDateString()]}),s.expiry_date&&e.jsxs("span",{children:["Expires: ",new Date(s.expiry_date).toLocaleDateString()]})]})})]})},s.id))})]}):e.jsx("div",{className:"py-8 text-center text-muted-foreground",children:e.jsx("div",{className:"text-sm",children:"No benefits configured for this scheme."})})})})]}),e.jsxs(d,{children:[e.jsxs(n,{children:[e.jsx(c,{children:"Members"}),e.jsx(l,{children:"Consumption based on approved claims in the last 12 months"})]}),e.jsx(m,{children:e.jsx("div",{className:"space-y-4",children:(f=t.members)!=null&&f.length?t.members.map(s=>{const i=t.price?Math.min(100,Math.round(s.amount_spent_12m/t.price*100)):0,w=i>70?"bg-destructive":"bg-success";return e.jsxs("div",{className:"p-3 border rounded",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("div",{className:"font-medium",children:s.username}),e.jsxs("div",{className:"text-muted-foreground",children:[i,"% used"]})]}),e.jsx("div",{className:"h-2 mt-2 rounded bg-muted",children:e.jsx("div",{className:`h-2 rounded ${w}`,style:{width:`${i}%`}})}),e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:["Joined ",new Date(s.joined).toLocaleDateString()," • Next renewal ",new Date(s.next_renewal).toLocaleDateString()]})]},s.id)}):e.jsx("div",{className:"text-sm text-muted-foreground",children:"No members yet."})})})]}),e.jsx(D,{open:b,onOpenChange:j,schemeId:t.id})]}):null}export{F as default};

import{j as e}from"./ui-vendor-BwlLg9O9.js";import{C as b,a as C,b as S,d as P}from"./card-B87lmAsb.js";import{T as F,a as R,b as v,c as i,d as B,e as l}from"./table-xhyeBtUg.js";import{B as $}from"./badge-BSpsjrqz.js";import{r as a}from"./react-vendor-BV8CqAlW.js";import{B as D,a as L,h as Q}from"./index-DvB6HgzU.js";import{S as O}from"./skeleton-CR7iafWw.js";import{f as E}from"./currency-DQnJccph.js";import{I as x}from"./input-CqLO7V2k.js";import{L as c}from"./label-_J7CDay_.js";import{X as W,u as Z}from"./utils-vendor-BEyFXcp4.js";import{T as ee,a as se,b as M,c as H}from"./tabs-CT2nD0Ou.js";function ae({open:o,onOpenChange:h,onSuccess:m}){const[p,g]=a.useState(""),[f,y]=a.useState(""),[u,N]=a.useState(""),[n,d]=a.useState(""),[k,I]=a.useState(""),[A,_]=a.useState(!1),[w,j]=a.useState(null),[T,s]=a.useState(""),[r,G]=a.useState(""),[U,V]=a.useState(""),[X,q]=a.useState(""),[z,J]=a.useState("");async function Y(t){t.preventDefault(),_(!0),j(null);try{await L.post("/api/accounts/register/",{username:p,email:f,password:u,first_name:n,last_name:k,role:"PROVIDER",facility_name:T,facility_type:r||void 0,phone:U,address:X,city:z}),h(!1),m==null||m(),g(""),y(""),N(""),d(""),I(""),s(""),G(""),V(""),q(""),J("")}catch(K){j(K.message||"Failed to add provider")}finally{_(!1)}}return o?e.jsx("div",{className:"fixed inset-0 z-50 grid place-items-center bg-black/40 p-4",onClick:()=>h(!1),children:e.jsxs(b,{className:"w-full max-w-md",onClick:t=>t.stopPropagation(),children:[e.jsxs(C,{className:"flex flex-row items-center justify-between",children:[e.jsx(S,{children:"Add Provider"}),e.jsx(D,{variant:"ghost",size:"icon",onClick:()=>h(!1),className:"h-6 w-6",children:e.jsx(W,{className:"h-4 w-4"})})]}),e.jsx(P,{className:"max-h-[70vh] overflow-y-auto",children:e.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Username"}),e.jsx(x,{value:p,onChange:t=>g(t.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Email"}),e.jsx(x,{type:"email",value:f,onChange:t=>y(t.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Password"}),e.jsx(x,{type:"password",value:u,onChange:t=>N(t.target.value),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"First name"}),e.jsx(x,{value:n,onChange:t=>d(t.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Last name"}),e.jsx(x,{value:k,onChange:t=>I(t.target.value)})]})]}),e.jsx("div",{className:"pt-2 text-sm font-medium",children:"Facility details"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Facility name"}),e.jsx(x,{value:T,onChange:t=>s(t.target.value),placeholder:"e.g. CityCare Clinic"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Facility type"}),e.jsxs("select",{className:"h-9 w-full rounded-md border bg-background px-3 text-sm",value:r,onChange:t=>G(t.target.value),children:[e.jsx("option",{value:"",children:"Select type…"}),e.jsx("option",{value:"HOSPITAL",children:"Hospital"}),e.jsx("option",{value:"CLINIC",children:"Clinic"}),e.jsx("option",{value:"PHARMACY",children:"Pharmacy"}),e.jsx("option",{value:"LAB",children:"Laboratory"}),e.jsx("option",{value:"IMAGING",children:"Imaging Center"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Phone"}),e.jsx(x,{value:U,onChange:t=>V(t.target.value),placeholder:"e.g. +265…"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"Address"}),e.jsx(x,{value:X,onChange:t=>q(t.target.value),placeholder:"Street, area"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{children:"City"}),e.jsx(x,{value:z,onChange:t=>J(t.target.value),placeholder:"City/town"})]})]}),w&&e.jsx("div",{className:"text-sm text-destructive",children:w}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(D,{type:"button",variant:"ghost",onClick:()=>h(!1),children:"Cancel"}),e.jsx(D,{type:"submit",disabled:A,children:A?"Saving…":"Add Provider"})]})]})})]})}):null}function ve(){const[o,h]=a.useState(null),[m,p]=a.useState(!0),[g,f]=a.useState(null),[y,u]=a.useState(!1),[N,n]=a.useState("dashboard"),[d,k]=a.useState(null),[I,A]=a.useState([]),[_,w]=a.useState(!1),[j,T]=a.useState(null);return a.useEffect(()=>{let s=!0;return Q().then(r=>{s&&h(r)}).catch(r=>{s&&f(r.message||"Failed to load")}).finally(()=>{s&&p(!1)}),()=>{s=!1}},[]),a.useEffect(()=>{d&&(w(!0),Promise.all([L.get(`/api/claims/?provider=${d}&ordering=-date_submitted`),L.get(`/api/core/analytics/providers/${d}/`)]).then(([s,r])=>{A(s.results??s),T(r)}).catch(()=>{A([]),T(null)}).finally(()=>w(!1)))},[d]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-end justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Providers"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Ranking by volume and approval rate."})]}),e.jsxs(D,{onClick:()=>u(!0),children:[e.jsx(Z,{className:"h-4 w-4 mr-2"})," Add Provider"]})]}),e.jsxs(ee,{value:N,onValueChange:n,className:"mb-4",children:[e.jsxs(se,{children:[e.jsx(M,{value:"dashboard",children:"Dashboard"}),e.jsx(M,{value:"claims",children:"Claims"}),e.jsx(M,{value:"analytics",children:"Analytics"})]}),e.jsx(H,{value:"dashboard",children:e.jsxs(b,{children:[e.jsx(C,{children:e.jsx(S,{className:"text-base",children:"Top Providers"})}),e.jsx(P,{children:e.jsx("div",{className:"overflow-auto",children:e.jsxs(F,{children:[e.jsx(R,{children:e.jsxs(v,{children:[e.jsx(i,{children:"Provider"}),e.jsx(i,{children:"Claims"}),e.jsx(i,{children:"Approval %"}),e.jsx(i,{children:"Approved Amount"}),e.jsx(i,{children:"Avg Proc (days)"})]})}),e.jsxs(B,{children:[m&&Array.from({length:8}).map((s,r)=>e.jsx(v,{children:e.jsx(l,{colSpan:5,children:e.jsx(O,{className:"h-4 w-full"})})},r)),!m&&(o==null?void 0:o.results.map(s=>e.jsxs(v,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>{k(s.provider_id),n("claims")},children:[e.jsx(l,{children:s.provider}),e.jsx(l,{children:s.total_claims.toLocaleString()}),e.jsxs(l,{children:[(s.approval_rate*100).toFixed(1),"%"]}),e.jsx(l,{children:E(s.approved_amount)}),e.jsx(l,{children:s.avg_processing_days.toFixed(2)})]},s.provider_id)))]})]})})})]})}),e.jsx(H,{value:"claims",children:e.jsxs(b,{children:[e.jsx(C,{children:e.jsx(S,{children:"Recent Claims"})}),e.jsxs(P,{children:[!d&&e.jsx("div",{className:"text-xs text-muted-foreground",children:"Select a provider from Dashboard"}),d&&e.jsx("div",{className:"overflow-auto",children:e.jsxs(F,{children:[e.jsx(R,{children:e.jsxs(v,{children:[e.jsx(i,{children:"Date"}),e.jsx(i,{children:"Member"}),e.jsx(i,{children:"Service"}),e.jsx(i,{children:"Amount"}),e.jsx(i,{children:"Status"})]})}),e.jsxs(B,{children:[_&&Array.from({length:6}).map((s,r)=>e.jsx(v,{children:e.jsx(l,{colSpan:5,children:e.jsx(O,{className:"h-4 w-full"})})},r)),!_&&I.map(s=>{var r;return e.jsxs(v,{children:[e.jsx(l,{children:s.date_of_service?new Date(s.date_of_service).toLocaleDateString():"—"}),e.jsx(l,{children:((r=s.patient_detail)==null?void 0:r.user_username)||"—"}),e.jsx(l,{children:s.service_type_name||"—"}),e.jsx(l,{children:E(s.cost)}),e.jsx(l,{children:e.jsx($,{variant:s.status==="APPROVED"?"success":s.status==="PENDING"?"warning":s.status==="REJECTED"?"destructive":"outline",children:s.status})})]},s.id)})]})]})})]})]})}),e.jsx(H,{value:"analytics",children:e.jsxs(b,{children:[e.jsx(C,{children:e.jsx(S,{children:"Analytics"})}),e.jsxs(P,{children:[!d&&e.jsx("div",{className:"text-xs text-muted-foreground",children:"Select a provider from Dashboard"}),d&&j&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm",children:["Totals: Approved ",E(j.totals.approved_amount)," • Pending ",E(j.totals.pending_amount)," • Approval ",(j.totals.approval_rate*100).toFixed(1),"%"]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-1 font-medium",children:"Top Services"}),e.jsxs(F,{children:[e.jsx(R,{children:e.jsxs(v,{children:[e.jsx(i,{children:"Service"}),e.jsx(i,{children:"Count"}),e.jsx(i,{children:"Amount"})]})}),e.jsx(B,{children:j.top_services.map((s,r)=>e.jsxs(v,{children:[e.jsx(l,{children:s.service_type}),e.jsx(l,{children:s.count}),e.jsx(l,{children:E(s.amount)})]},r))})]})]})]})]})]})})]}),e.jsx(te,{}),e.jsx(ae,{open:y,onOpenChange:u})]})}function te(){const[o,h]=a.useState(""),[m,p]=a.useState(!1),[g,f]=a.useState(null),[y,u]=a.useState(null);async function N(){p(!0),u(null),f(null);try{const n=await L.post("/api/core/edi/submit/",{x12:o});f(n)}catch(n){u(n.message||"Failed to submit EDI")}finally{p(!1)}}return e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(b,{children:[e.jsx(C,{children:e.jsx(S,{children:"Provider Network Management"})}),e.jsxs(P,{children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-2",children:"Directory and credentialing (basic placeholder)."}),e.jsx("div",{className:"text-xs",children:"Coming soon: add/remove providers to network, upload credentialing documents."})]})]}),e.jsxs(b,{children:[e.jsx(C,{children:e.jsx(S,{children:"EDI Integration"})}),e.jsxs(P,{className:"space-y-2",children:[e.jsx("textarea",{className:"w-full h-32 border rounded p-2 text-sm",placeholder:"Paste X12 here (e.g., 837P)",value:o,onChange:n=>h(n.target.value)}),e.jsx(D,{onClick:N,disabled:m||!o.trim(),children:"Submit"}),y&&e.jsx("div",{className:"text-xs text-destructive",children:y}),g&&e.jsxs("div",{className:"text-xs",children:[e.jsxs("div",{children:["Status: ",e.jsx($,{children:g.status})]}),e.jsx("pre",{className:"mt-2 whitespace-pre-wrap bg-muted p-2 rounded",children:JSON.stringify(g,null,2)})]})]})]})]})}export{ve as default};

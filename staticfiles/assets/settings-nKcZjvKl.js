import{j as e}from"./ui-vendor-BwlLg9O9.js";import{C as c,a as u,b as h,d}from"./card-B87lmAsb.js";import{I as p}from"./input-CqLO7V2k.js";import{L as l}from"./label-_J7CDay_.js";import{u as H,B as R,a as v}from"./index-DvB6HgzU.js";import{r as i}from"./react-vendor-BV8CqAlW.js";import{S as I}from"./skeleton-CR7iafWw.js";import"./utils-vendor-BEyFXcp4.js";function V(){const{user:t}=H(),[z,y]=i.useState(null),[b,N]=i.useState([]),[P,S]=i.useState(!0),[k,_]=i.useState(!1),[C,w]=i.useState(!1),[E,g]=i.useState(null),[F,j]=i.useState(null),[m,D]=i.useState({accent_color:"#2E7DFF",logo_url:"/logo.svg",notifications_enabled:!0,email_alerts:!0,language:"en",timezone:"UTC"}),[f,A]=i.useState({});i.useEffect(()=>{t&&(async()=>{try{S(!0),g(null),j(null);const a={id:(t==null?void 0:t.id)||0,accent_color:"#2E7DFF",logo_url:"/logo.svg",notifications_enabled:!0,email_alerts:!0,language:"en",timezone:"UTC"};if(y(a),D(a),(t==null?void 0:t.role)==="ADMIN")try{const n=await v.get("/api/core/settings/"),o=n.results||n;N(o);const T={};o.forEach(U=>{T[U.key]=U.value}),A(T)}catch(r){console.error("Error fetching system settings:",r),j("Failed to load system settings")}}catch(a){console.error("Error fetching settings:",a),g("Failed to load settings")}finally{S(!1)}})()},[t]);const M=async()=>{try{_(!0),g(null),await new Promise(s=>setTimeout(s,1e3)),y({...z,...m})}catch(s){console.error("Error saving settings:",s),g("Failed to save settings")}finally{_(!1)}},x=(s,a)=>{D(r=>({...r,[s]:a}))},L=(s,a)=>{A(r=>({...r,[s]:a}))},B=async()=>{try{w(!0),j(null);const s=b.map(o=>({key:o.key,value:f[o.key]||o.value,value_type:o.value_type,description:o.description}));await v.post("/api/core/settings/bulk_update/",s);const a=await v.get("/api/core/settings/"),n=a.results||a;N(n)}catch(s){console.error("Error saving system settings:",s),j("Failed to save system settings")}finally{w(!1)}};return P?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Settings"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Configure application preferences."})]}),e.jsxs(c,{children:[e.jsx(u,{children:e.jsx(h,{className:"text-base",children:"User Preferences"})}),e.jsx(d,{className:"grid max-w-xl grid-cols-1 gap-4",children:Array.from({length:4}).map((s,a)=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{className:"h-4 w-24"}),e.jsx(I,{className:"h-10 w-full"})]},a))})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Settings"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Configure application preferences."})]}),E&&e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsx("div",{className:"text-center text-destructive",children:E})})}),e.jsxs(c,{children:[e.jsx(u,{children:e.jsx(h,{className:"text-base",children:"Appearance"})}),e.jsxs(d,{className:"grid max-w-xl grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"accent",children:"Accent Color"}),e.jsx(p,{id:"accent",type:"color",value:m.accent_color,onChange:s=>x("accent_color",s.target.value),placeholder:"#2E7DFF"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"logo",children:"Logo URL"}),e.jsx(p,{id:"logo",value:m.logo_url,onChange:s=>x("logo_url",s.target.value),placeholder:"/logo.svg"})]})]})]}),e.jsxs(c,{children:[e.jsx(u,{children:e.jsx(h,{className:"text-base",children:"Notifications"})}),e.jsxs(d,{className:"space-y-4 max-w-xl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"notifications",children:"Push Notifications"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive notifications in the app"})]}),e.jsx("input",{type:"checkbox",id:"notifications",checked:m.notifications_enabled,onChange:s=>x("notifications_enabled",s.target.checked),className:"h-4 w-4"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"email-alerts",children:"Email Alerts"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive important alerts via email"})]}),e.jsx("input",{type:"checkbox",id:"email-alerts",checked:m.email_alerts,onChange:s=>x("email_alerts",s.target.checked),className:"h-4 w-4"})]})]})]}),e.jsxs(c,{children:[e.jsx(u,{children:e.jsx(h,{className:"text-base",children:"Regional"})}),e.jsxs(d,{className:"grid max-w-xl grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"language",children:"Language"}),e.jsxs("select",{id:"language",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:m.language,onChange:s=>x("language",s.target.value),children:[e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"es",children:"Spanish"}),e.jsx("option",{value:"fr",children:"French"})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"timezone",children:"Timezone"}),e.jsxs("select",{id:"timezone",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:m.timezone,onChange:s=>x("timezone",s.target.value),children:[e.jsx("option",{value:"UTC",children:"UTC"}),e.jsx("option",{value:"America/New_York",children:"Eastern Time"}),e.jsx("option",{value:"America/Chicago",children:"Central Time"}),e.jsx("option",{value:"America/Denver",children:"Mountain Time"}),e.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time"}),e.jsx("option",{value:"Europe/London",children:"London"}),e.jsx("option",{value:"Europe/Paris",children:"Paris"}),e.jsx("option",{value:"Asia/Tokyo",children:"Tokyo"})]})]})]})]}),e.jsxs(c,{children:[e.jsx(u,{children:e.jsx(h,{className:"text-base",children:"Profile Information"})}),e.jsxs(d,{className:"grid max-w-xl grid-cols-1 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{children:"Username"}),e.jsx(p,{value:(t==null?void 0:t.username)||"",disabled:!0})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Email"}),e.jsx(p,{value:"user@example.com",disabled:!0})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Role"}),e.jsx(p,{value:(t==null?void 0:t.role)||"",disabled:!0})]})]})]}),(t==null?void 0:t.role)==="ADMIN"&&e.jsxs(e.Fragment,{children:[F&&e.jsx(c,{children:e.jsx(d,{className:"p-6",children:e.jsx("div",{className:"text-center text-destructive",children:F})})}),e.jsxs(c,{children:[e.jsxs(u,{children:[e.jsx(h,{className:"text-base",children:"System Configuration"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Configure system-wide settings and thresholds"})]}),e.jsx(d,{className:"space-y-6",children:b.map(s=>{var a,r;return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(l,{htmlFor:s.key,className:"text-sm font-medium",children:s.key.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase())}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.value_type})]}),s.value_type==="boolean"?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:s.key,checked:((a=f[s.key])==null?void 0:a.toLowerCase())==="true",onChange:n=>L(s.key,n.target.checked?"true":"false"),className:"h-4 w-4"}),e.jsx(l,{htmlFor:s.key,className:"text-sm",children:((r=f[s.key])==null?void 0:r.toLowerCase())==="true"?"Enabled":"Disabled"})]}):e.jsx(p,{id:s.key,type:s.value_type==="decimal"||s.value_type==="integer"?"number":"text",value:f[s.key]||"",onChange:n=>L(s.key,n.target.value),placeholder:`Enter ${s.key.toLowerCase().replace(/_/g," ")}`,step:s.value_type==="decimal"?"0.01":void 0}),s.description&&e.jsx("p",{className:"text-xs text-muted-foreground",children:s.description}),s.updated_by_name&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Last updated by ",s.updated_by_name," on ",new Date(s.updated_at).toLocaleDateString()]})]},s.key)})})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(R,{onClick:M,disabled:k,children:k?"Saving...":"Save User Settings"}),(t==null?void 0:t.role)==="ADMIN"&&e.jsx(R,{onClick:B,disabled:C,variant:"outline",children:C?"Saving...":"Save System Settings"})]})]})}export{V as default};
